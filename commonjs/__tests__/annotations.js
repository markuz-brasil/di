"use strict";

jest.autoMockOff();
require('6to5/polyfill');

var annotate = require('../index').annotate;
var hasAnnotation = require('../index').hasAnnotation;
var readAnnotations = require('../index').readAnnotations;
var Inject = require('../index').Inject;
var InjectLazy = require('../index').InjectLazy;
var InjectPromise = require('../index').InjectPromise;
var Provide = require('../index').Provide;
var ProvidePromise = require('../index').ProvidePromise;


describe("hasAnnotation", function () {
  it("should return false if fn not annotated", function () {
    function foo() {}
    var Bar = function Bar() {};

    var SomeAnnotation = function SomeAnnotation() {};

    expect(hasAnnotation(foo, SomeAnnotation)).toBe(false);
    expect(hasAnnotation(Bar, SomeAnnotation)).toBe(false);
  });


  it("should return true if the fn has an instance of given annotation", function () {
    var SomeAnnotation = function SomeAnnotation() {};

    annotate(foo, new SomeAnnotation());
    function foo() {}

    expect(hasAnnotation(foo, SomeAnnotation)).toBe(true);
  });


  it("should return false if fn does not have given annotation", function () {
    var YepAnnotation = function YepAnnotation() {};

    var NopeAnnotation = function NopeAnnotation() {};

    annotate(foo, new YepAnnotation());
    function foo() {}

    expect(hasAnnotation(foo, NopeAnnotation)).toBe(false);
  });
});

describe("readAnnotations", function () {
  it("should read @Provide", function () {
    var Bar = function Bar() {};

    var Foo = function Foo() {};

    annotate(Foo, new Provide(Bar));

    var annotations = readAnnotations(Foo);

    expect(annotations.provide.token).toBe(Bar);
    expect(annotations.provide.isPromise).toBe(false);
  });

  it("should read @ProvidePromise", function () {
    var Bar = function Bar() {};

    var Foo = function Foo() {};

    annotate(Foo, new ProvidePromise(Bar));

    var annotations = readAnnotations(Foo);

    expect(annotations.provide.token).toBe(Bar);
    expect(annotations.provide.isPromise).toBe(true);
  });

  it("should read @Inject", function () {
    var One = function One() {};

    var Two = function Two() {};

    var Foo = function Foo() {};

    annotate(Foo, new Inject(One, Two));

    var annotations = readAnnotations(Foo);

    expect(annotations.params[0].token).toBe(One);
    expect(annotations.params[0].isPromise).toBe(false);
    expect(annotations.params[0].isLazy).toBe(false);

    expect(annotations.params[1].token).toBe(Two);
    expect(annotations.params[1].isPromise).toBe(false);
    expect(annotations.params[1].isLazy).toBe(false);
  });

  it("should read @InjectLazy", function () {
    var One = function One() {};

    var Foo = function Foo() {};

    annotate(Foo, new InjectLazy(One));

    var annotations = readAnnotations(Foo);

    expect(annotations.params[0].token).toBe(One);
    expect(annotations.params[0].isPromise).toBe(false);
    expect(annotations.params[0].isLazy).toBe(true);
  });

  it("should read @InjectPromise", function () {
    var One = function One() {};

    var Foo = function Foo() {};

    annotate(Foo, new InjectPromise(One));

    var annotations = readAnnotations(Foo);

    expect(annotations.params[0].token).toBe(One);
    expect(annotations.params[0].isPromise).toBe(true);
    expect(annotations.params[0].isLazy).toBe(false);
  });

  it("should read stacked @Inject{Lazy, Promise} annotations", function () {
    var One = function One() {};

    var Two = function Two() {};

    var Three = function Three() {};

    var Foo = function Foo() {};

    annotate(Foo, new Inject(One));
    annotate(Foo, new InjectLazy(Two));
    annotate(Foo, new InjectPromise(Three));

    var annotations = readAnnotations(Foo);

    expect(annotations.params[0].token).toBe(One);
    expect(annotations.params[0].isPromise).toBe(false);
    expect(annotations.params[0].isLazy).toBe(false);

    expect(annotations.params[1].token).toBe(Two);
    expect(annotations.params[1].isPromise).toBe(false);
    expect(annotations.params[1].isLazy).toBe(true);

    expect(annotations.params[2].token).toBe(Three);
    expect(annotations.params[2].isPromise).toBe(true);
    expect(annotations.params[2].isLazy).toBe(false);
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9fdGVzdHNfXy9hbm5vdGF0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQTs7O0lBSWhCLFFBQVEsdUJBQVIsUUFBUTtJQUNSLGFBQWEsdUJBQWIsYUFBYTtJQUNiLGVBQWUsdUJBQWYsZUFBZTtJQUNmLE1BQU0sdUJBQU4sTUFBTTtJQUNOLFVBQVUsdUJBQVYsVUFBVTtJQUNWLGFBQWEsdUJBQWIsYUFBYTtJQUNiLE9BQU8sdUJBQVAsT0FBTztJQUNQLGNBQWMsdUJBQWQsY0FBYzs7O0FBR2hCLFFBQVEsQ0FBQyxlQUFlLEVBQUUsWUFBVztBQUVuQyw0REFBeUQ7QUFFdkQsYUFBUyxHQUFHLEdBQUcsRUFBRTtRQUNYLEdBQUcsWUFBSCxHQUFHOztRQUNILGNBQWMsWUFBZCxjQUFjOztBQUVwQiwyREFBc0Q7QUFDdEQsMkRBQXNEO0tBQ3REOzs7QUFHRixxRkFBa0Y7UUFFMUUsY0FBYyxZQUFkLGNBQWM7O0FBRXBCLFlBQVEsQ0FBQyxHQUFHLEVBQUUsSUFBSSxjQUFjLEVBQUUsQ0FBQyxDQUFBO0FBQ25DLGFBQVMsR0FBRyxHQUFHLEVBQUU7O0FBRWpCLFVBQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0dBQ3RELENBQUMsQ0FBQTs7O0FBR0YsSUFBRSxDQUFDLDBEQUEwRCxFQUFFLFlBQVc7UUFFbEUsYUFBYSxZQUFiLGFBQWE7O1FBQ2IsY0FBYyxZQUFkLGNBQWM7O0FBRXBCLFlBQVEsQ0FBQyxHQUFHLEVBQUUsSUFBSSxhQUFhLEVBQUUsQ0FBQyxDQUFBO0FBQ2xDLGFBQVMsR0FBRyxHQUFHLEVBQUU7O0FBRWpCLFVBQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFBO0dBQ3ZELENBQUMsQ0FBQTtDQUNILENBQUMsQ0FBQTs7QUFFRixRQUFRLENBQUMsaUJBQWlCLEVBQUUsWUFBVztBQUVyQyxJQUFFLENBQUMsc0JBQXNCLEVBQUUsWUFBVztRQUM5QixHQUFHLFlBQUgsR0FBRzs7UUFFSCxHQUFHLFlBQUgsR0FBRzs7QUFDVCxZQUFRLENBQUMsR0FBRyxFQUFFLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7O0FBRS9CLFFBQUksV0FBVyxHQUFHLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTs7QUFFdEMsVUFBTSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQzNDLFVBQU0sQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtHQUNsRCxDQUFDLENBQUE7O0FBRUYsSUFBRSxDQUFDLDZCQUE2QixFQUFFLFlBQVc7UUFDckMsR0FBRyxZQUFILEdBQUc7O1FBRUgsR0FBRyxZQUFILEdBQUc7O0FBQ1QsMkNBQXNDOztBQUV0QywyQ0FBc0M7O0FBRXRDLGdEQUEyQztBQUMzQyxxREFBZ0Q7S0FDaEQ7O0FBRUYsd0NBQXFDO1FBQzdCLEdBQUcsWUFBSCxHQUFHOztRQUNILEdBQUcsWUFBSCxHQUFHOztRQUVILEdBQUcsWUFBSCxHQUFHOztBQUNULFlBQVEsQ0FBQyxHQUFHLEVBQUUsSUFBSSxNQUFNLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUE7O0FBRW5DLFFBQUksV0FBVyxHQUFHLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTs7QUFFdEMsVUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQzdDLFVBQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNuRCxVQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7O0FBRWhELFVBQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUM3QyxVQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDbkQsVUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFBO0dBQ2pELENBQUMsQ0FBQTs7QUFFRixJQUFFLENBQUMseUJBQXlCLEVBQUUsWUFBVztRQUNqQyxHQUFHLFlBQUgsR0FBRzs7UUFFSCxHQUFHLFlBQUgsR0FBRzs7QUFDVCxZQUFRLENBQUMsR0FBRyxFQUFFLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7O0FBRWxDLFFBQUksV0FBVyxHQUFHLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTs7QUFFdEMsVUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQzdDLFVBQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNuRCxVQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7R0FDaEQsQ0FBQyxDQUFBOztBQUVGLElBQUUsQ0FBQyw0QkFBNEIsRUFBRSxZQUFXO1FBQ3BDLEdBQUcsWUFBSCxHQUFHOztRQUVILEdBQUcsWUFBSCxHQUFHOztBQUNULFlBQVEsQ0FBQyxHQUFHLEVBQUUsSUFBSSxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQTs7QUFFckMsUUFBSSxXQUFXLEdBQUcsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFBOztBQUV0QyxVQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7QUFDN0MsVUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQ2xELFVBQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtHQUNqRCxDQUFDLENBQUE7O0FBRUYsSUFBRSxDQUFDLHdEQUF3RCxFQUFFLFlBQVc7UUFDaEUsR0FBRyxZQUFILEdBQUc7O1FBQ0gsR0FBRyxZQUFILEdBQUc7O1FBQ0gsS0FBSyxZQUFMLEtBQUs7O1FBRUwsR0FBRyxZQUFILEdBQUc7O0FBQ1QsWUFBUSxDQUFDLEdBQUcsRUFBRSxJQUFJLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO0FBQzlCLFlBQVEsQ0FBQyxHQUFHLEVBQUUsSUFBSSxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQTtBQUNsQyxZQUFRLENBQUMsR0FBRyxFQUFFLElBQUksYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUE7O0FBRXZDLFFBQUksV0FBVyxHQUFHLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQTs7QUFFdEMsVUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQzdDLFVBQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNuRCxVQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7O0FBRWhELFVBQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUM3QyxVQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDbkQsVUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBOztBQUUvQyxVQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDL0MsVUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQ2xELFVBQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtHQUNqRCxDQUFDLENBQUE7Q0FDSCxDQUFDLENBQUEiLCJmaWxlIjoiX190ZXN0c19fL2Fubm90YXRpb25zLmpzIiwic291cmNlc0NvbnRlbnQiOlsiamVzdC5hdXRvTW9ja09mZigpXG5pbXBvcnQgJzZ0bzUvcG9seWZpbGwnXG5cbmltcG9ydCB7XG4gIGFubm90YXRlLFxuICBoYXNBbm5vdGF0aW9uLFxuICByZWFkQW5ub3RhdGlvbnMsXG4gIEluamVjdCxcbiAgSW5qZWN0TGF6eSxcbiAgSW5qZWN0UHJvbWlzZSxcbiAgUHJvdmlkZSxcbiAgUHJvdmlkZVByb21pc2Vcbn0gZnJvbSAnLi4vaW5kZXgnXG5cbmRlc2NyaWJlKCdoYXNBbm5vdGF0aW9uJywgZnVuY3Rpb24oKSB7XG5cbiAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgaWYgZm4gbm90IGFubm90YXRlZCcsIGZ1bmN0aW9uKCkge1xuXG4gICAgZnVuY3Rpb24gZm9vKCkge31cbiAgICBjbGFzcyBCYXIge31cbiAgICBjbGFzcyBTb21lQW5ub3RhdGlvbiB7fVxuXG4gICAgZXhwZWN0KGhhc0Fubm90YXRpb24oZm9vLCBTb21lQW5ub3RhdGlvbikpLnRvQmUoZmFsc2UpXG4gICAgZXhwZWN0KGhhc0Fubm90YXRpb24oQmFyLCBTb21lQW5ub3RhdGlvbikpLnRvQmUoZmFsc2UpXG4gIH0pXG5cblxuICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIGlmIHRoZSBmbiBoYXMgYW4gaW5zdGFuY2Ugb2YgZ2l2ZW4gYW5ub3RhdGlvbicsIGZ1bmN0aW9uKCkge1xuXG4gICAgY2xhc3MgU29tZUFubm90YXRpb24ge31cblxuICAgIGFubm90YXRlKGZvbywgbmV3IFNvbWVBbm5vdGF0aW9uKCkpXG4gICAgZnVuY3Rpb24gZm9vKCkge31cblxuICAgIGV4cGVjdChoYXNBbm5vdGF0aW9uKGZvbywgU29tZUFubm90YXRpb24pKS50b0JlKHRydWUpXG4gIH0pXG5cblxuICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSBpZiBmbiBkb2VzIG5vdCBoYXZlIGdpdmVuIGFubm90YXRpb24nLCBmdW5jdGlvbigpIHtcblxuICAgIGNsYXNzIFllcEFubm90YXRpb24ge31cbiAgICBjbGFzcyBOb3BlQW5ub3RhdGlvbiB7fVxuXG4gICAgYW5ub3RhdGUoZm9vLCBuZXcgWWVwQW5ub3RhdGlvbigpKVxuICAgIGZ1bmN0aW9uIGZvbygpIHt9XG5cbiAgICBleHBlY3QoaGFzQW5ub3RhdGlvbihmb28sIE5vcGVBbm5vdGF0aW9uKSkudG9CZShmYWxzZSlcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKCdyZWFkQW5ub3RhdGlvbnMnLCBmdW5jdGlvbigpIHtcblxuICBpdCgnc2hvdWxkIHJlYWQgQFByb3ZpZGUnLCBmdW5jdGlvbigpIHtcbiAgICBjbGFzcyBCYXIge31cblxuICAgIGNsYXNzIEZvbyB7fVxuICAgIGFubm90YXRlKEZvbywgbmV3IFByb3ZpZGUoQmFyKSlcblxuICAgIHZhciBhbm5vdGF0aW9ucyA9IHJlYWRBbm5vdGF0aW9ucyhGb28pXG5cbiAgICBleHBlY3QoYW5ub3RhdGlvbnMucHJvdmlkZS50b2tlbikudG9CZShCYXIpXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnByb3ZpZGUuaXNQcm9taXNlKS50b0JlKGZhbHNlKVxuICB9KVxuXG4gIGl0KCdzaG91bGQgcmVhZCBAUHJvdmlkZVByb21pc2UnLCBmdW5jdGlvbigpIHtcbiAgICBjbGFzcyBCYXIge31cblxuICAgIGNsYXNzIEZvbyB7fVxuICAgIGFubm90YXRlKEZvbywgbmV3IFByb3ZpZGVQcm9taXNlKEJhcikpXG5cbiAgICB2YXIgYW5ub3RhdGlvbnMgPSByZWFkQW5ub3RhdGlvbnMoRm9vKVxuXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnByb3ZpZGUudG9rZW4pLnRvQmUoQmFyKVxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wcm92aWRlLmlzUHJvbWlzZSkudG9CZSh0cnVlKVxuICB9KVxuXG4gIGl0KCdzaG91bGQgcmVhZCBASW5qZWN0JywgZnVuY3Rpb24oKSB7XG4gICAgY2xhc3MgT25lIHt9XG4gICAgY2xhc3MgVHdvIHt9XG5cbiAgICBjbGFzcyBGb28ge31cbiAgICBhbm5vdGF0ZShGb28sIG5ldyBJbmplY3QoT25lLCBUd28pKVxuXG4gICAgdmFyIGFubm90YXRpb25zID0gcmVhZEFubm90YXRpb25zKEZvbylcblxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMF0udG9rZW4pLnRvQmUoT25lKVxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMF0uaXNQcm9taXNlKS50b0JlKGZhbHNlKVxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMF0uaXNMYXp5KS50b0JlKGZhbHNlKVxuXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1sxXS50b2tlbikudG9CZShUd28pXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1sxXS5pc1Byb21pc2UpLnRvQmUoZmFsc2UpXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1sxXS5pc0xhenkpLnRvQmUoZmFsc2UpXG4gIH0pXG5cbiAgaXQoJ3Nob3VsZCByZWFkIEBJbmplY3RMYXp5JywgZnVuY3Rpb24oKSB7XG4gICAgY2xhc3MgT25lIHt9XG5cbiAgICBjbGFzcyBGb28ge31cbiAgICBhbm5vdGF0ZShGb28sIG5ldyBJbmplY3RMYXp5KE9uZSkpXG5cbiAgICB2YXIgYW5ub3RhdGlvbnMgPSByZWFkQW5ub3RhdGlvbnMoRm9vKVxuXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1swXS50b2tlbikudG9CZShPbmUpXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1swXS5pc1Byb21pc2UpLnRvQmUoZmFsc2UpXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1swXS5pc0xhenkpLnRvQmUodHJ1ZSlcbiAgfSlcblxuICBpdCgnc2hvdWxkIHJlYWQgQEluamVjdFByb21pc2UnLCBmdW5jdGlvbigpIHtcbiAgICBjbGFzcyBPbmUge31cblxuICAgIGNsYXNzIEZvbyB7fVxuICAgIGFubm90YXRlKEZvbywgbmV3IEluamVjdFByb21pc2UoT25lKSlcblxuICAgIHZhciBhbm5vdGF0aW9ucyA9IHJlYWRBbm5vdGF0aW9ucyhGb28pXG5cbiAgICBleHBlY3QoYW5ub3RhdGlvbnMucGFyYW1zWzBdLnRva2VuKS50b0JlKE9uZSlcbiAgICBleHBlY3QoYW5ub3RhdGlvbnMucGFyYW1zWzBdLmlzUHJvbWlzZSkudG9CZSh0cnVlKVxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMF0uaXNMYXp5KS50b0JlKGZhbHNlKVxuICB9KVxuXG4gIGl0KCdzaG91bGQgcmVhZCBzdGFja2VkIEBJbmplY3R7TGF6eSwgUHJvbWlzZX0gYW5ub3RhdGlvbnMnLCBmdW5jdGlvbigpIHtcbiAgICBjbGFzcyBPbmUge31cbiAgICBjbGFzcyBUd28ge31cbiAgICBjbGFzcyBUaHJlZSB7fVxuXG4gICAgY2xhc3MgRm9vIHt9XG4gICAgYW5ub3RhdGUoRm9vLCBuZXcgSW5qZWN0KE9uZSkpXG4gICAgYW5ub3RhdGUoRm9vLCBuZXcgSW5qZWN0TGF6eShUd28pKVxuICAgIGFubm90YXRlKEZvbywgbmV3IEluamVjdFByb21pc2UoVGhyZWUpKVxuXG4gICAgdmFyIGFubm90YXRpb25zID0gcmVhZEFubm90YXRpb25zKEZvbylcblxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMF0udG9rZW4pLnRvQmUoT25lKVxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMF0uaXNQcm9taXNlKS50b0JlKGZhbHNlKVxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMF0uaXNMYXp5KS50b0JlKGZhbHNlKVxuXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1sxXS50b2tlbikudG9CZShUd28pXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1sxXS5pc1Byb21pc2UpLnRvQmUoZmFsc2UpXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1sxXS5pc0xhenkpLnRvQmUodHJ1ZSlcblxuICAgIGV4cGVjdChhbm5vdGF0aW9ucy5wYXJhbXNbMl0udG9rZW4pLnRvQmUoVGhyZWUpXG4gICAgZXhwZWN0KGFubm90YXRpb25zLnBhcmFtc1syXS5pc1Byb21pc2UpLnRvQmUodHJ1ZSlcbiAgICBleHBlY3QoYW5ub3RhdGlvbnMucGFyYW1zWzJdLmlzTGF6eSkudG9CZShmYWxzZSlcbiAgfSlcbn0pXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=